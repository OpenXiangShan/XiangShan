# This file describes the GitHub Actions workflow for continuous integration of XS Core.
name: EMU Test

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  generate-verilog:
    runs-on: self-hosted
    name: Generate Verilog
    steps:
      - uses: actions/checkout@v2
        with:
          submodules: 'recursive'
      - name: main
        run:
          PERF_DIR=/bigdata/xs-perf/${GITHUB_RUN_ID}_${GITHUB_SHA:0:5}
          echo "PERF_HOME=$PERF_DIR" >> $GITHUB_ENV
          bash .github/workflows/generate_verilog.sh
  emu-basics:
    runs-on: self-hosted
    name: EMU - Basics
    steps:
      - uses: actions/checkout@v2
        with:
          submodules: 'recursive'
      - name: main
        run:
          PERF_DIR=/bigdata/xs-perf/${GITHUB_RUN_ID}_${GITHUB_SHA:0:5}
          echo "PERF_HOME=$PERF_DIR" >> $GITHUB_ENV
          bash .github/workflows/basic_test.sh
  emu-performance:
    runs-on: self-hosted
    name: EMU - Performance
    steps:
      - uses: actions/checkout@v2
        with:
          submodules: 'recursive'
      - name: main
        run:
          PERF_DIR=/bigdata/xs-perf/${GITHUB_RUN_ID}_${GITHUB_SHA:0:5}
          echo "PERF_HOME=$PERF_DIR" >> $GITHUB_ENV
          bash .github/workflows/performance_test.sh


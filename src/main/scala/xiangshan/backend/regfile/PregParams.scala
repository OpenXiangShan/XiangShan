package xiangshan.backend.regfile

import chisel3.util._
import xiangshan.backend.datapath.DataConfig._

abstract class PregParams {
  val numEntries: Int
  val numBank   : Int
  val numRead   : Option[Int]
  val numWrite  : Option[Int]
  val dataCfg   : DataConfig
  val isFake    : Boolean

  def addrWidth = log2Up(numEntries)
  // addr for datas after read each bank
  def bankRaddrWidth = log2Ceil(numBank)
  // addr for read each bank
  def arbiterAddrWidth = addrWidth - bankRaddrWidth
}

case class IntPregParams(
  numEntries: Int,
  numBank   : Int,
  numRead   : Option[Int],
  numWrite  : Option[Int],
) extends PregParams {

  val dataCfg: DataConfig = IntData()
  val isFake: Boolean = false
}

case class FpPregParams(
                          numEntries: Int,
                          numBank   : Int,
                          numRead   : Option[Int],
                          numWrite  : Option[Int],
                        ) extends PregParams {

  val dataCfg: DataConfig = FpData()
  val isFake: Boolean = false
}

case class VfPregParams(
  numEntries: Int,
  numBank   : Int,
  numRead   : Option[Int],
  numWrite  : Option[Int],
) extends PregParams {

  val dataCfg: DataConfig = VecData()
  val isFake: Boolean = false
}

case class V0PregParams(
  numEntries: Int,
  numBank: Int,
  numRead   : Option[Int],
  numWrite  : Option[Int],
) extends PregParams {

  val dataCfg: DataConfig = V0Data()
  val isFake: Boolean = false
}

case class VlPregParams(
  numEntries: Int,
  numBank   : Int,
  numRead   : Option[Int],
  numWrite  : Option[Int],
) extends PregParams {

  val dataCfg: DataConfig = VlData()
  val isFake: Boolean = false
}

case class NoPregParams() extends PregParams {
  val numEntries: Int = 0
  val numBank   : Int = 0
  val numRead   : Option[Int] = None
  val numWrite  : Option[Int] = None

  val dataCfg: DataConfig = NoData()
  val isFake: Boolean = false
}

case class FakeIntPregParams(
  numEntries: Int,
  numBank   : Int,
  numRead   : Option[Int],
  numWrite  : Option[Int],
) extends PregParams {

  val dataCfg: DataConfig = FakeIntData()
  val isFake: Boolean = true
}
